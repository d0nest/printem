<!-- create account -->
<!DOCTYPE html>
<html>
<head>
    <style>
        h4 {
            margin: 0px;
            padding: 0px;
        }
    </style>
</head>

<body>
    <h4 id="warning">warnings will appear here!</h4>
    <h2>create account</h2>
    <form id="form">
        <table>
            <tbody>
                <tr>
                    <td>username:</td>
                    <td>
                        <input name="username" id="username" type="text" size="20" autocapitalize="false" autofocus="false"
                            autocomplete="false" spellcheck="false">
                    </td>
                </tr>
                <tr>
                    <td>password:</td>
                    <td>
                        <input id="pass" name="password" size="20" >
                    </td>
                </tr>
            </tbody>
        </table>
        <br>
        <input type="submit" value="create account">
    </form>
    <script>
        const username = document.getElementById('username');
        const pass = document.getElementById('pass');
        const form = document.getElementById('form');
        
        form.onsubmit = async function(event){
            event.preventDefault()
            if(!validation()){
                document.getElementById('warning').innerText = 'don\'t you dare leave any of those rectangular boxes empty!'
            }
            else{
                new FormData(form);
            }
        }
        
        form.onformdata = async function(event){
            const data = event.formData;
            try{
                const res = await fetch('http://localhost:3000/create/account', { method: 'POST', body: data });
                if(res.status === 200){
                    window.location.href = '/dashboard'
                }
                else{
                    document.getElementById('warning').innerText = res.statusText;
                }
            }
            catch(error){
                console.log('error while sending create account', error);
            }
        }
        
        function validation(){
            let result;
            return username.value.trim() === '' || pass.value.trim() === ''? false : true;
        }
    </script>
        
</body>

</html>